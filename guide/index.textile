
@src/main/webapp/WEB-INF/web.xml@ 

pre.. 
<web-app ...>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:/conf/uApprove.xml;</param-value>
    </context-param>
    
    ...
    
    <filter>
        <filter-name>uApprove</filter-name>
        <filter-class>ch.SWITCH.aai.uApprove.Intercepter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>uApprove</filter-name>
        <url-pattern>/profile/*</url-pattern>
        <url-pattern>/Authn/UserPassword</url-pattern>
    </filter-mapping>

    <servlet>
        <servlet-name>uApprove - Terms Of Use</servlet-name>
        <servlet-class>ch.SWITCH.aai.uApprove.tou.ToUServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>uApprove - Terms Of Use</servlet-name>
        <url-pattern>/uApprove/TermsOfUse</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>uApprove - Attribute Release</servlet-name>
        <servlet-class>ch.SWITCH.aai.uApprove.ar.AttributeReleaseServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>uApprove - Attribute Release</servlet-name>
        <url-pattern>/uApprove/AttributeRelease</url-pattern>
    </servlet-mapping>

</web-app>

h3. Consent revocation on the login page

@src/main/webapp/login.jsp@

pre.. 

             <tr>
               <td>&nbsp;</td>
               <td>
                    <input id="uApprove.consent-revocation" type="checkbox" name="uApprove.consent-revocation" value="true"/>
                    <label for="uApprove.consent-revocation">Reset consent</label>
               </td>
             </tr>


h3. ToU Schema:

pre.. 
CREATE TABLE ToUAcceptance (
    userId              VARCHAR(256)                                NOT NULL,
    version             VARCHAR(64)                                 NOT NULL,
    fingerprint         VARCHAR(256)                                NOT NULL,
    acceptanceDate      TIMESTAMP       DEFAULT CURRENT_TIMESTAMP   NOT NULL,
    
    PRIMARY KEY (userId, version)
);



